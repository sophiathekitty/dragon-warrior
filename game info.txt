type:game,title:Dragon Warrior,name:Dragon,engine:rpg
║type:player═

level:1,
hp:15,mp:0,
strength:4,
agility:4,
xp:0,
gold:0,
keys:0═

weapon:Bamboo Pole,
shield:,
armor:,
ring:,
necklace:,
belt:═

map:throne,
x:2,
y:5




║type:item,item_type:weapon═

name:Bamboo Pole,
offense:2,
cost:10═

name:Club,
offense:4,
cost:10═

name:Copper Sword,
offense:10,
cost:180═

name:Hand Axe,
offense:15,
cost:560═

name:Broad Sword,
offense:20,
cost:1500═

name:Flame Sword,
offense:28,
cost:9800═

name:Erdrick's Sword,
offense:40


║type:item,item_type:armor═

name:Clothes,
defense:2,
cost:20═

name:Leather Armor,
defense:4,
cost:70═

name:Chain Mail,
defense:10,
cost:300═

name:Half Plate,
defense:16,
cost:1000═

name:Full Plate,
defense:24,
cost:3000═

name:Magic Armor,
defense:24,
cost:7700═

name:Erdrick's Armor,
defense:28


║type:item,item_type:shield═

name:Small Shield,
defense:4,
cost:90═

name:Large Shield,
defense:10,
cost:800═

name:Silver Shield,
defense:20,
cost:14800


║type:item,item_type:use═

name:Herb,
cost:24,
effect:herb═

name:Wings,
cost:70,
effect:return_home═

name:Torch,
cost:8,
effect:torch═

name:Fairy Water,
cost:38,
effect:avoid_encounters═

name:Light Orb═

name:Erdrick's Tablet,
effect:read_tablet═

name:Silver Harp,
effect:silver_harp═

name:Rain Staff═

name:Sunstone═

name:Gwaelin's Love,
effect:distance_from_castle═

name:Erdrick's Token═

name:Rainbow Drop


║type:item,item_type:necklace═

name:Dragon's Scale,
defense:2,
cost:20═

name:Cursed Necklace,
cost:1200


║type:item,item_type:ring═

name:Fighter's Ring,
offense:2,
cost:15


║type:item,item_type:belt═

name:Cursed Belt,cost:180


║type:action,
name:magic,
level:player.level,
cost:player.mp═

name:Heal,
level:3,
cost:3,
effect:cast_heal═

name:Hurt,
level:4,
cost:2,
combat:true,
effect:cast_hurt═

name:Sleep,
level:7,
cost:2,
combat:true,
effect:cast_sleep═

name:Radiant,
level:9,
cost:2,
combat:false,
effect:cast_radiant═

name:StopSpell,
level:10,
cost:2,
combat:true,
effect:cast_stop═

name:Outside,
level:12,
cost:6,
combat:false,
effect:cast_outside═

name:Return,
level:13,
cost:8,
combat:false,
effect:return_home═

name:Repel,
level:15,
cost:2,
combat:false,
effect:avoid_encounters═

name:HealMore,
level:17,
cost:8,
effect:cast_healmore═

name:HurtMore,
level:19,
cost:5,
combat:true,
effect:cast_hurtmore




║type:logic


═action:DamagePlayer;
    sub:player.hp=ints.damage;
    if:player.hp>0;
        exit;
    endif;
    go:outworld,47,45;
    setto:player.hp=playerMax.hp;
    setto:player.mp=playerMax.mp;
    setto:int.gold=player.gold;
    div:ints.gold=4;
    sub:player.gold=ints.gold;
    if:player.gold<0;
        set:player.gold=0;
    endif;
    say:Thou hast nearly perished. But thy adventure must go on. ints.gold of thy gold hast been lost to the Dragonlord's minions.;


═action:PlayerStep;
    sub:ints.fairySteps=1;
    sub:ints.radiantSteps=1;
    if:ints.fairySteps<0;
        set:ints.fairySteps=0;
    endif;
    if:ints.radiantSteps=0;
        set:map.darkRadius=1;
    endif;
    if:ints.radiantSteps<0;
        set:ints.radiantSteps=0;
    endif;
    if:ints.radiantSteps=60;
        set:map.darkRadius=2;
    endif;
    if:ints.radiantSteps=120;
        set:map.darkRadius=3;
    endif;
    if:map.OnToxicTile=true;
        setto:ints.damage=map.ToxicLevel;
        run:DamagePlayer;
    endif;
    if:map.name=outworld;
        set:map.darkRadius=1;
        setto:ints.east=player.x;
        sub:ints.east=46;
        set:ints.west=46;
        sub:ints.west=player.x;
        setto:ints.south=player.y;
        sub:ints.south=46;
        set:ints.north=46;
        sub:ints.north=player.y;
    endif;
    run:RandomEncounter;

═action:RandomEncounter;
    if:ints.fairySteps>0;
        exit;
    endif;
    if:map.hasEncounters=false;
        exit;
    endif;
    if:map.OnDangerTile=true;
        set:ints.encounterThreshold = 30;
    else;
        set:ints.encounterThreshold = 15;
    endif;
    rand:ints.encounterCheck=0,100;
    if:ints.encounterCheck<ints.encounterThreshold;
        encounter:maps.encounter;

═action:WinEncounter;
    add:player.xp=enemy.xp;
    if:player.xp<playerMax.xp;
        exit;
    endif;
    add:player.level=1;
    if:player.level>30;
        player.level=30;
        exit;
    endif;
    if:player.level=2;
        set:playerMax.xp=23;
        add:playerMax.hp=7;
        add:playerMax.strength=1;
        say:Thou hast leveled up! Thy strength hast increased by 1 and thy hp has increased by 7.;
    elseif:player.level=3;
        set:playerMax.xp=47;
        add:playerMax.strength=2;
        add:playerMax.agility=2;
        add:playerMax.hp=2;
        add:playerMax.mp=7;
        say:Thou hast leveled up! Thy strength, hp, and agility hast increased by 2. Thy mp has increased to 7 and thou has learned Heal.;
    elseif:player.level>3;
        setto:ints.xpIncrease=playerMax.xp;
        div:ints.xpIncrease/3;
        add:playerMax.xp=ints.xpIncrease;        
        rand:ints.hpIncrease=2,15;
        add:playerMax.hp=ints.hpIncrease;
        rand:ints.mpIncrease=2,20;
        add:playerMax.mp=ints.mpIncrease;
        rand:ints.agilityIncrease=2,8;
        add:playerMax.agility=ints.agilityIncrease;
        rand:ints.strengthIncrease=2,10;
        add:playerMax.strength=ints.strengthIncrease;
        say:Thou hast leveled up! Thy strength hast increased by ints.strengthIncrease and thy agility hast increased by ints.agilityIncrease. Thy hp hast increased by ints.hpIncrease and thy mp hast increased by ints.mpIncrease.;

═action:return_home;
    if:map.name=outworld;
        go:outworld,47,45;

═action:torch;
    set:map.darkRadius=2;
    take:Torch;

═action:avoid_encounters;
    set:ints.fairySteps=128;

═action:herb;
    rand:ints.restore=20,30;
    add:player.hp=ints.restore;
    if:player.hp>playerMax.hp;
        setto:player.hp=playerMax.hp;

═action:silver_harp;
    encounter:Slime,Red Slime,Drakee,Ghost,Magician,Scorpion;


═action:distance_from_castle;
    if:ints.north>0;if:ints.west>0;
        say:Thou art ints.north North by ints.west West of the castle my love.;
    endif;
    if:ints.north>0;if:ints.east>0;
        say:Thou art ints.north North by ints.east East of the castle my love.;
    endif;
    if:ints.north>0;if:ints.east=0;
        say:Thou art ints.north North of the castle my love.;
    endif;
    if:ints.south>0;if:ints.west>0;
        say:Thou art ints.south South by ints.west West of the castle my love.;
    endif;
    if:ints.south>0;if:ints.east>0;
        say:Thou art ints.south South by ints.east East of the castle my love.;
    endif;
    if:ints.south>0;if:ints.east=0;
        say:Thou art ints.south South of the castle my love.;
    endif;
    

═action:read_tablet;
    say:this should be some sort of hint i guess but... woops... i haven't looked up what it should be at this point.;

═action:cast_heal;
    rand:ints.restore=25,30;
    add:player.hp=ints.restore;
    if:player.hp>playerMax.hp;
        setto:player.hp=playerMax.hp;

═action:cast_hurt;
    rand:ints.spellChance=1,16;
    if:enemy.hurtResist>ints.spellChance;
        say:Thou casts Hurt but fail to hit thou target.;
    endif;
    rand:ints.damage=8,12;
    sub:enemy.hp=ints.damage;

═action:cast_sleep;
    rand:ints.spellChance=1,16;
    if:enemy.sleepResist>ints.spellChance;
        say:Thou hast cast Sleep but enemy.name resists.;
    endif;
    set:enemy.status=sleep;
    say:Thou hast put enemy.name to sleep.;

═action:cast_radiant;
    set:ints.radiantSteps=200;
    say:Thou hast cast radiant.;
═action:cast_stop;
    rand:ints.spellChance=1,16;
    if:enemy.stopResist>ints.spellChance;
        say:Thou hast cast Stop but it had no effect.;
═action:cast_outside;
    if:map.name=outworld;
        say:Thoust art already outside.;
    endif;
    go:map.Exit;

═action:cast_healmore;
    rand:ints.restore=25,30;
    add:player.hp=ints.restore;
    if:player.hp>playerMax.hp;
        setto:player.hp=playerMax.hp;
═action:cast_hurtmore;
    rand:ints.spellChance=1,16;
    if:enemy.hurtResist>ints.spellChance;
        say:Thou casts Hurt but fail to hit thou target.;
    endif;
    rand:ints.damage=58,65;
    sub:enemy.hp=ints.damage;

